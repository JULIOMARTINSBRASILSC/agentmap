mappamundi:
  cli:
    src:
      cli.ts:
        description: CLI entrypoint for generating codebase maps.
      extract:
        definitions.ts:
          description: Extract top-level definitions using tree-sitter.
          defs:
            extractArrowFunction: line 439-460, function
            extractConstName: line 345-372, function
            extractDefinition: line 125-251, function
            extractDefinitions: line 87-120, function, exported
            extractGoName: line 418-434, function
            extractJSName: line 374-386, function
            extractMultipleDeclarations: line 256-298, function
            extractName: line 319-340, function
            extractPythonName: line 388-396, function
            extractRustName: line 398-416, function
            unwrapExport: line 303-314, function
        git-status.ts:
          description: |-
            Parse git diff output and calculate definition-level diff stats.
            Uses defensive git options for cross-platform reliability.
          defs:
            applyDiffToDefinitions: line 307-326, function, exported
            calculateDefinitionDiff: line 225-278, function, exported
            calculateFileDiff: line 284-302, function, exported
            getAllDiffData: line 196-217, function, exported
            normalizePath: line 23-32, function
            parseDiff: line 114-172, function, exported
            parseHunkHeader: line 97-108, function, exported
            parseNumstat: line 57-92, function, exported
            safeExec: line 37-49, function
        marker.ts:
          description: Extract @agentmap marker and description from file header.
          defs:
            extractDescription: line 83-132, function
            extractMarker: line 28-60, function, exported
            isCommentLine: line 65-78, function
            readHead: line 13-22, function
            stripCommentPrefix: line 147-156, function
      index.ts:
        description: Library exports for programmatic usage.
      map:
        builder.ts:
          description: Build the nested map object from file results.
          defs:
            buildMap: line 10-19, function, exported
            formatDefinition: line 38-68, function
            formatFileDiff: line 24-33, function
            insertFile: line 73-106, function
        yaml.ts:
          description: Format map object to YAML string.
          defs:
            sortKeys: line 10-22, function
            toYaml: line 27-36, function, exported
      parser:
        index.ts:
          description: Tree-sitter parser initialization and code parsing.
          defs:
            parseCode: line 33-41, function, exported
        languages.ts:
          description: Language detection and grammar loading for tree-sitter.
          defs:
            getGrammarPath: line 39-52, function
            LANGUAGE_EXTENSIONS: line 13-26, const, exported
            loadGrammar: line 73-83, function, exported
      scanner.ts:
        description: Scan directory for files with @agentmap marker.
        defs:
          getGitFiles: line 45-71, function
          getGlobFiles: line 76-84, function
          isGitRepo: line 31-38, function
          processFile: line 155-192, function
          scanDirectory: line 89-150, function, exported
      types.ts:
        description: Core type definitions for the codebase map.
        defs:
          DefEntry: line 19-21, interface, exported
          Definition: line 83-90, interface, exported
          DefinitionDiff: line 74-78, interface, exported
          DefinitionStatus: line 69, type, exported
          DefinitionType: line 58-64, type, exported
          DiffHunk: line 119-124, interface, exported
          FileDiff: line 129-132, interface, exported
          FileDiffStats: line 26-29, interface, exported
          FileEntry: line 34-38, interface, exported
          FileResult: line 95-100, interface, exported
          GenerateOptions: line 105-114, interface, exported
          Language: line 9-14, type, exported
          MapNode: line 43-45, interface, exported
          MarkerResult: line 50-53, interface, exported
          SyntaxNode: line 137, type, exported
          SyntaxTree: line 138, type, exported
  opencode:
    src:
      index.ts:
        description: OpenCode plugin that injects codebase map into system prompt.
        defs:
          AgentMapPlugin: line 7-31, function, exported

